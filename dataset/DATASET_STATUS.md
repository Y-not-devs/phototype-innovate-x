# üéâ –í–∞—à –¥–∞—Ç–∞—Å–µ—Ç –≥–æ—Ç–æ–≤ –∫ –æ–±—É—á–µ–Ω–∏—é!

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞

### –ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ (–ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º)
- **–ü–æ–¥–ø–∏—Å–∏ (signature)**: 103
- **–ü–µ—á–∞—Ç–∏ (stamp)**: 60
- **QR-–∫–æ–¥—ã (qr)**: 95
- **–í—Å–µ–≥–æ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π**: 258

### –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ train/val
- **Train**: 68 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π + 72 –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏
- **Val**: 16 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π + 19 –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π
- **–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ**: ~80/20

### –§–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã
‚úÖ `dataset/labels/train/` - 72 YOLO –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ (.txt)
‚úÖ `dataset/labels/val/` - 19 YOLO –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ (.txt)
‚úÖ `dataset/images/train/` - 129 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚úÖ `dataset/images/val/` - 16 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚úÖ `dataset/dataset.yaml` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è YOLO

## üîß –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

1. ‚úÖ **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è JSON ‚Üí YOLO**
   - `selected_annotations.json` –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω –≤ .txt —Ñ–∞–π–ª—ã
   - –§–æ—Ä–º–∞—Ç: `class_id center_x center_y width height`
   - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω—ã (0-1)

2. ‚úÖ **–ú–∞–ø–ø–∏–Ω–≥ –∫–ª–∞—Å—Å–æ–≤**
   ```python
   0: signature  # –ü–æ–¥–ø–∏—Å–∏
   1: stamp      # –ü–µ—á–∞—Ç–∏
   2: qr         # QR-–∫–æ–¥—ã
   ```

3. ‚úÖ **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/val**
   - 80% –¥–∞–Ω–Ω—ã—Ö ‚Üí train
   - 20% –¥–∞–Ω–Ω—ã—Ö ‚Üí val
   - –°–ª—É—á–∞–π–Ω–æ–µ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ

4. ‚úÖ **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**
   - Val –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é –ø–∞–ø–∫—É
   - Train –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Å—Ç–∞–ª–∏—Å—å –Ω–∞ –º–µ—Å—Ç–µ

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### –ù–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (7 —Ñ–∞–π–ª–æ–≤)
–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –Ω–µ –∏–º–µ—é—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:

**Train:**
- —á–µ—Ä—Ç–µ–∂-_page_1
- —Ä–∞–∑—Ä–µ—à–Ω–∞–∑–µ–º–ª—é-_page_1
- –ü–∏—Å—å–º–æ-2_page_1
- –†–∞–∑—Ä–µ—à–Ω–∞–∑–µ–º–ª—é-41-_page_1

**Val:**
- –ø–∏—Å—å–º–æ-22_page_1
- –ü–∏—Å—å–º–æ-42_page_1
- —Ä–∞–∑—Ä–µ—à–Ω–∞–∑–µ–º–ª-2_page_1

**–†–µ—à–µ–Ω–∏–µ**: –õ–∏–±–æ –Ω–∞–π–¥–∏—Ç–µ —ç—Ç–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –ª–∏–±–æ —É–¥–∞–ª–∏—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ .txt —Ñ–∞–π–ª—ã –∏–∑ `dataset/labels/`

### –õ–∏—à–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (61 —Ñ–∞–π–ª –≤ train)
–í –ø–∞–ø–∫–µ train –µ—Å—Ç—å 61 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–µ–∑ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π. –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ - –æ–Ω–∏ –±—É–¥—É—Ç –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏.

## üöÄ –ì–æ—Ç–æ–≤—ã –∫ –æ–±—É—á–µ–Ω–∏—é!

### –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è

```powershell
# –ë–∞–∑–æ–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ (nano –º–æ–¥–µ–ª—å, CPU, 100 —ç–ø–æ—Ö)
python train_model.py

# –° GPU –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
python train_model.py --device cuda --epochs 200

# –ë–æ–ª–µ–µ –∫—Ä—É–ø–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –ª—É—á—à–µ–π —Ç–æ—á–Ω–æ—Å—Ç–∏
python train_model.py --model m --device cuda --epochs 200
```

### –û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è

**CPU (Intel i7)**:
- 100 epochs: ~1-2 —á–∞—Å–∞ (–¥–ª—è 68 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
- 200 epochs: ~2-4 —á–∞—Å–∞

**GPU (NVIDIA GTX 1080+)**:
- 100 epochs: ~10-15 –º–∏–Ω—É—Ç
- 200 epochs: ~20-30 –º–∏–Ω—É—Ç

### –ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è

–ú–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤:
```
runs/detect/document_detector/weights/best.pt
```

–û–±–Ω–æ–≤–∏—Ç–µ `router/router-service/app/main.py`:
```python
pipeline = DocumentAnalysisPipeline(
    model_path='runs/detect/document_detector/weights/best.pt',
    use_gpu=False  # True –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ GPU
)
```

–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã:
```powershell
cd router
python run.py
```

–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ:
```powershell
python router\test_cv_endpoint.py test_document.pdf
```

## üìà –û–∂–∏–¥–∞–µ–º–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å

–° —Ç–µ–∫—É—â–∏–º –¥–∞—Ç–∞—Å–µ—Ç–æ–º (68 train / 16 val):
- **mAP@0.5**: 0.6-0.7 (—Å—Ä–µ–¥–Ω—è—è —Ç–æ—á–Ω–æ—Å—Ç—å)
- **–ü–æ–¥–ø–∏—Å–∏**: 0.7-0.8 (—Ö–æ—Ä–æ—à–æ, 103 –ø—Ä–∏–º–µ—Ä–∞)
- **–ü–µ—á–∞—Ç–∏**: 0.6-0.7 (—Å—Ä–µ–¥–Ω–µ, 60 –ø—Ä–∏–º–µ—Ä–æ–≤)
- **QR-–∫–æ–¥—ã**: 0.7-0.8 (—Ö–æ—Ä–æ—à–æ, 95 –ø—Ä–∏–º–µ—Ä–æ–≤)

### –ö–∞–∫ —É–ª—É—á—à–∏—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å

1. **–î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö** (—Ü–µ–ª—å: 500+ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
2. **–£–≤–µ–ª–∏—á–∏—Ç—å epochs** (–¥–æ 200-300)
3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å yolov8m** –≤–º–µ—Å—Ç–æ yolov8n
4. **–î–æ–±–∞–≤–∏—Ç—å –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏** (—É–∂–µ –≤–∫–ª—é—á–µ–Ω—ã –≤ train_model.py)
5. **–ù–∞–π—Ç–∏ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ 7 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞

–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–∏–º–µ—Ä –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏:
```powershell
Get-Content dataset\labels\train\–ê–ü–ó-2_page_9.txt
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø–æ—Ö–æ–∂–µ –Ω–∞:
```
2 0.123456 0.234567 0.045678 0.056789
0 0.567890 0.678901 0.089012 0.090123
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞

```
dataset/
‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îú‚îÄ‚îÄ train/          # 129 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–≤–∫–ª—é—á–∞—è 61 –±–µ–∑ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π)
‚îÇ   ‚îî‚îÄ‚îÄ val/            # 16 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îú‚îÄ‚îÄ labels/
‚îÇ   ‚îú‚îÄ‚îÄ train/          # 72 –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ (.txt)
‚îÇ   ‚îî‚îÄ‚îÄ val/            # 19 –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π (.txt)
‚îú‚îÄ‚îÄ labels_converted/   # –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ñ–∞–π–ª—ã (–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å)
‚îú‚îÄ‚îÄ dataset.yaml        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è YOLO ‚úÖ
‚îú‚îÄ‚îÄ selected_annotations.json  # –ò—Å—Ö–æ–¥–Ω—ã–π JSON
‚îî‚îÄ‚îÄ masked_annotations.json    # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π JSON

raw_pdfs/               # –ò—Å—Ö–æ–¥–Ω—ã–µ PDF (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```

## üéØ Next Steps

1. ‚úÖ **–î–∞—Ç–∞—Å–µ—Ç –≥–æ—Ç–æ–≤**
2. ‚è≠Ô∏è  **–ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ**: `python train_model.py`
3. ‚è≠Ô∏è  **–ü–æ–¥–æ–∂–¥–∞—Ç—å 1-2 —á–∞—Å–∞** (CPU) –∏–ª–∏ 10-15 –º–∏–Ω—É—Ç (GPU)
4. ‚è≠Ô∏è  **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**: `runs/detect/document_detector/results.png`
5. ‚è≠Ô∏è  **–û–±–Ω–æ–≤–∏—Ç—å router-service** —Å –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª—å—é
6. ‚è≠Ô∏è  **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å** –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö

## üí° –°–æ–≤–µ—Ç—ã

- –°–ª–µ–¥–∏—Ç–µ –∑–∞ –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ –≤ `results.png` –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è
- –ï—Å–ª–∏ mAP@0.5 > 0.7 - –º–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ
- –ï—Å–ª–∏ mAP@0.5 < 0.5 - –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ epochs
- GPU —É—Å–∫–æ—Ä—è–µ—Ç –æ–±—É—á–µ–Ω–∏–µ –≤ ~10-20 —Ä–∞–∑

---

**–ì–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å? –ó–∞–ø—É—Å—Ç–∏—Ç–µ:**
```powershell
python train_model.py
```

üöÄ –£–¥–∞—á–∏ –≤ –æ–±—É—á–µ–Ω–∏–∏!
