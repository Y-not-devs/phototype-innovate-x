# Dataset –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –¥–µ—Ç–µ–∫—Ç–æ—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç –¥–∞—Ç–∞—Å–µ—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –æ–±—É—á–µ–Ω–∏—è YOLO –º–æ–¥–µ–ª–∏ –Ω–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ç—Ä–µ—Ö —Ç–∏–ø–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö:

- **–ü–æ–¥–ø–∏—Å–∏ (signature)** - class_id: 0
- **–ü–µ—á–∞—Ç–∏ (stamp)** - class_id: 1
- **QR-–∫–æ–¥—ã (qr_code)** - class_id: 2

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```text
dataset/
‚îú‚îÄ‚îÄ raw_pdfs/              # (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ò—Å—Ö–æ–¥–Ω—ã–µ PDF –¥–æ–∫—É–º–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ train/             # PDF –¥–ª—è train –Ω–∞–±–æ—Ä–∞
‚îÇ   ‚îî‚îÄ‚îÄ val/               # PDF –¥–ª—è validation –Ω–∞–±–æ—Ä–∞
‚îÇ
‚îú‚îÄ‚îÄ images/                # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ train/             # 80% –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ val/               # 20% –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
‚îÇ
‚îú‚îÄ‚îÄ labels/                # –†–∞–∑–º–µ—Ç–∫–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ YOLO
‚îÇ   ‚îú‚îÄ‚îÄ train/             # –ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –¥–ª—è train
‚îÇ   ‚îî‚îÄ‚îÄ val/               # –ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –¥–ª—è val
‚îÇ
‚îú‚îÄ‚îÄ dataset.yaml           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è YOLO
‚îî‚îÄ‚îÄ README.md              # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –î–æ–±–∞–≤—å—Ç–µ PDF –¥–æ–∫—É–º–µ–Ω—Ç—ã

```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–∞—à–∏ PDF –≤ –ø–∞–ø–∫—É raw_pdfs
cp /path/to/your/documents/*.pdf dataset/raw_pdfs/train/
cp /path/to/your/validation/*.pdf dataset/raw_pdfs/val/
```

### 2. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π—Ç–µ PDF –≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

```bash
# –ò–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞
python convert_pdfs.py dataset/raw_pdfs/train dataset/images/train
python convert_pdfs.py dataset/raw_pdfs/val dataset/images/val
```

### 3. –†–∞–∑–º–µ—Ç—å—Ç–µ –¥–∞–Ω–Ω—ã–µ

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ LabelImg –¥–ª—è —Ä–∞–∑–º–µ—Ç–∫–∏:

```bash
pip install labelImg
labelImg dataset/images/train dataset/labels/train
```

**–í–∞–∂–Ω–æ**:

- –§–æ—Ä–º–∞—Ç: YOLO
- –ö–ª–∞—Å—Å—ã: signature (0), stamp (1), qr_code (2)
- –ö–∞–∂–¥–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –∏–º–µ—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π .txt —Ñ–∞–π–ª

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞—Ç–∞—Å–µ—Ç

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π
# Windows PowerShell:
(Get-ChildItem dataset/images/train).Count
(Get-ChildItem dataset/labels/train).Count
```

### 5. –û–±—É—á–∏—Ç–µ –º–æ–¥–µ–ª—å

```bash
python train_model.py
```

## üìä –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Train: –º–∏–Ω–∏–º—É–º 300 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- Val: –º–∏–Ω–∏–º—É–º 75 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –ü—Ä–∏–º–µ—Ä–æ–≤ –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞: –º–∏–Ω–∏–º—É–º 100

### –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç

- Train: 1000-5000 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- Val: 250-1250 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ: 80/20 (train/val)

### –ö–∞—á–µ—Å—Ç–≤–æ

- –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ: –º–∏–Ω–∏–º—É–º 640x640, –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ 1024x1024+
- –§–æ—Ä–º–∞—Ç: JPG –∏–ª–∏ PNG
- DPI –ø—Ä–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ PDF: 300
- –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ: —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –ø–µ—á–∞—Ç–µ–π, –ø–æ—á–µ—Ä–∫–æ–≤

## üìù –§–æ—Ä–º–∞—Ç —Ä–∞–∑–º–µ—Ç–∫–∏ YOLO

–ö–∞–∂–¥—ã–π `.txt` —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç—Ä–æ–∫–∏:

```text
<class_id> <center_x> <center_y> <width> <height>
```

–í—Å–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω—ã (0.0 - 1.0).

### –ü—Ä–∏–º–µ—Ä (contract_001.txt)

```text
0 0.5234 0.7821 0.1456 0.0893
1 0.3421 0.8012 0.1234 0.1234
2 0.0821 0.0912 0.0567 0.0567
```

–≠—Ç–æ –∑–Ω–∞—á–∏—Ç:

- **–ü–æ–¥–ø–∏—Å—å** –≤ —Ü–µ–Ω—Ç—Ä–µ –≤–Ω–∏–∑—É
- **–ü–µ—á–∞—Ç—å** —Å–ª–µ–≤–∞ –≤–Ω–∏–∑—É
- **QR-–∫–æ–¥** –≤ –≤–µ—Ä—Ö–Ω–µ–º –ª–µ–≤–æ–º —É–≥–ª—É

## üîß –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞

–°–æ–∑–¥–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç `check_dataset.py`:

```python
from pathlib import Path

def check_dataset():
    """–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞—Ç–∞—Å–µ—Ç–∞"""
    
    for split in ['train', 'val']:
        images_dir = Path(f'dataset/images/{split}')
        labels_dir = Path(f'dataset/labels/{split}')
        
        images = set(f.stem for f in images_dir.glob('*.jpg'))
        images.update(f.stem for f in images_dir.glob('*.png'))
        labels = set(f.stem for f in labels_dir.glob('*.txt'))
        
        print(f"\n{split.upper()}:")
        print(f"  –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: {len(images)}")
        print(f"  –ê–Ω–Ω–æ—Ç–∞—Ü–∏–π: {len(labels)}")
        
        # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ
        missing_labels = images - labels
        missing_images = labels - images
        
        if missing_labels:
            print(f"  ‚ö†Ô∏è –ù–µ—Ç –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π –¥–ª—è: {missing_labels}")
        if missing_images:
            print(f"  ‚ö†Ô∏è –ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è: {missing_images}")
        
        if not missing_labels and not missing_images:
            print(f"  ‚úì –í—Å–µ —Ñ–∞–π–ª—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç")

if __name__ == '__main__':
    check_dataset()
```

## üéØ –°–æ–≤–µ—Ç—ã –ø–æ —Ä–∞–∑–º–µ—Ç–∫–µ

1. **–¢–æ—á–Ω–æ—Å—Ç—å bbox**: –†–∞–º–∫–∞ –¥–æ–ª–∂–Ω–∞ –ø–ª–æ—Ç–Ω–æ –æ–±–≤–æ–¥–∏—Ç—å –æ–±—ä–µ–∫—Ç
2. **–ü–æ–ª–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã**: –ï—Å–ª–∏ –ø–µ—á–∞—Ç—å —á–∞—Å—Ç–∏—á–Ω–æ –∑–∞ –∫—Ä–∞–µ–º, –Ω–µ —Ä–∞–∑–º–µ—á–∞–π—Ç–µ
3. **–°–ª–æ–∂–Ω—ã–µ —Å–ª—É—á–∞–∏**: –†–∞–∑–º—ã—Ç—ã–µ –ø–æ–¥–ø–∏—Å–∏ –º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å
4. **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**: –†–∞–∑–º–µ—á–∞–π—Ç–µ –ø–æ—Ö–æ–∂–∏–µ –æ–±—ä–µ–∫—Ç—ã –æ–¥–∏–Ω–∞–∫–æ–≤–æ
5. **–ü—Ä–æ–≤–µ—Ä–∫–∞**: –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π—Ç–µ —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±—É—á–µ–Ω–∏—è

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ `train_model.py` —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤:

```text
runs/detect/document_detector/
‚îú‚îÄ‚îÄ weights/
‚îÇ   ‚îú‚îÄ‚îÄ best.pt          # –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç—É)
‚îÇ   ‚îî‚îÄ‚îÄ last.pt          # –ü–æ—Å–ª–µ–¥–Ω—è—è —ç–ø–æ—Ö–∞
‚îú‚îÄ‚îÄ results.png          # –ì—Ä–∞—Ñ–∏–∫ –º–µ—Ç—Ä–∏–∫
‚îú‚îÄ‚îÄ confusion_matrix.png # –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫
‚îî‚îÄ‚îÄ ...
```

## üêõ Troubleshooting

### –û—à–∏–±–∫–∞: "No labels found"

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:

- –§–∞–π–ª—ã .txt –≤ `labels/train/` –∏ `labels/val/`
- –ò–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
- –§–æ—Ä–º–∞—Ç —Ä–∞–∑–º–µ—Ç–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

### –û—à–∏–±–∫–∞: "Invalid YOLO format"

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ:

- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 0-1
- 5 –∑–Ω–∞—á–µ–Ω–∏–π –Ω–∞ —Å—Ç—Ä–æ–∫—É
- class_id —ç—Ç–æ 0, 1 –∏–ª–∏ 2

### –ù–∏–∑–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏

- –°–æ–±–µ—Ä–∏—Ç–µ –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö (–º–∏–Ω–∏–º—É–º 1000)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞–∑–º–µ—Ç–∫–∏
- –£–≤–µ–ª–∏—á—å—Ç–µ epochs (200-300)
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª–µ–µ –∫—Ä—É–ø–Ω—É—é –º–æ–¥–µ–ª—å (yolov8m)

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–°–º. —Ç–∞–∫–∂–µ:

- `../DATASET_GUIDE.md` - –ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
- `../train_model.py` - –°–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è
- `../convert_pdfs.py` - –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è PDF

## üìä –°—Ç–∞—Ç—É—Å –¥–∞—Ç–∞—Å–µ—Ç–∞

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ—Å–ª–µ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:

- [ ] Train –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: ___
- [ ] Val –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: ___
- [ ] –ü–æ–¥–ø–∏—Å–µ–π —Ä–∞–∑–º–µ—á–µ–Ω–æ: ___
- [ ] –ü–µ—á–∞—Ç–µ–π —Ä–∞–∑–º–µ—á–µ–Ω–æ: ___
- [ ] QR-–∫–æ–¥–æ–≤ —Ä–∞–∑–º–µ—á–µ–Ω–æ: ___
- [ ] –ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞: [ ]
- [ ] –¢–æ—á–Ω–æ—Å—Ç—å: ___ mAP@0.5
